<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>抽奖大转盘</title>
  <style>
    .container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 50px;
    }

    .turnplate-wrapper {
      position: relative;
      width: 300px;
      height: 300px;
    }

    .pointer {
      position: absolute;
      left: 50%;
      top: 20%;
      margin-left: -15px;
      width: 30px;
      height: 120px;
      background-image: url('https://img.icons8.com/emoji/48/000000/yellow-circle-emoji.png');
      background-size: cover;
      transform-origin: bottom center;
    }

    .result {
      font-size: 36px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
    }

    button {
      margin-top: 20px;
      padding: 10px 20px;
      border-radius: 5px;
      background-color: #4CAF50;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="turnplate-wrapper">
      <div class="pointer"></div>
      <canvas id="canvas" width="300" height="300"></canvas>
    </div>
    <div class="result">抽奖结果</div>
    <button onclick="start()">开始抽奖</button>
  </div>

  <!-- 抽奖项目 -->
  <div id="items" style="display:none;">
    <input type="text" id="item1" placeholder="抽奖项目1" />
    <input type="text" id="item2" placeholder="抽奖项目2" />
    <input type="text" id="item3" placeholder="抽奖项目3" />
    <input type="text" id="item4" placeholder="抽奖项目4" />
    <input type="text" id="item5" placeholder="抽奖项目5" />
    <input type="text" id="item6" placeholder="抽奖项目6" />
    <input type="text" id="item7" placeholder="抽奖项目7" />
    <input type="text" id="item8" placeholder="抽奖项目8" />
    <input type="text" id="item9" placeholder="抽奖项目9" />
    <input type="text" id="item10" placeholder="抽奖项目10" />
  </div>

  <script>
    const items = [];
    for (let i = 1; i <= 10; i++) {
      const item = document.querySelector(`#item${i}`).value.trim();
      if (item !== '') {
        items.push(item);
      }
    }

    const canvas = document.getElementById('canvas');
    const context = canvas.getContext('2d');
    const colors = ['#FFA07A', '#20B2AA', '#6495ED', '#DC143C', '#EEE8AA', '#00CED1'];

    let speed = 0;
    let isRunning = false;
    let selectedIndex = -1;

    function drawTurnplate() {
      context.clearRect(0, 0, 300, 300);
      for (let i = 0; i < items.length; i++) {
        const color = colors[i % colors.length];
        context.beginPath();
        context.moveTo(150, 150);
        context.arc(150, 150, 130, 2 * Math.PI / items.length * i, 2 * Math.PI / items.length * (i + 1));
        context.closePath();
        context.fillStyle = color;
        context.fill();

        context.save();
        context.translate(150, 150);
        context.rotate(1.5 * Math.PI / items.length + 2 * Math.PI / items.length * i);
        context.textAlign = 'center';
        context.fillStyle = 'white';
        context.font = 'bold 18px Arial';
        context.fillText(items[i], 0, -60);
        context.restore();
      }
    }

    function start() {
      if (items.length === 0) {
        return;
      }
      if (isRunning) {
        return;
      }
      isRunning = true;

      selectedIndex = -1;
      const rounds = Math.floor(Math.random() * 4 + 4); // 4-7轮
      const targetIndex = Math.floor(Math.random() * items.length);
      const duration = rounds * items.length * 2000;

      const rotate = () => {
        speed -= 10;
        if (speed <= -duration) {
          speed = -duration;
          const newIndex = targetIndex;
          setTimeout(() => {
            selectedIndex = newIndex;
            isRunning = false;
            document.querySelector('.result').innerHTML = items[selectedIndex];
          }, 500);
          return;
        }
        drawTurnplate();
        context.save();
        context.translate(150, 150);
        context.rotate(speed * 2 * Math.PI / duration);
        context.drawImage(document.querySelector('.pointer'), -15, -120);
        context.restore();
        requestAnimationFrame(rotate);
      };

      rotate();
    }

    drawTurnplate();
  </script>
</body>

</html>